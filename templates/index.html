<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Insurance Claim Prediction</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f7fb;
            min-height: 100vh;
        }

        .main-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-top: 2rem;
            margin-bottom: 2rem;
            padding: 2rem;
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1f2937;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #6b7280;
            text-align: center;
            margin-bottom: 2rem;
        }

        .form-label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-control, .form-select {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.95rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 0.2rem rgba(59, 130, 246, 0.25);
        }

        .btn-custom {
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            border-radius: 8px;
            border: none;
            transition: all 0.2s;
        }

        .btn-primary-custom {
            background-color: #3b82f6;
            color: white;
        }

        .btn-primary-custom:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
        }

        .btn-outline-custom {
            background-color: transparent;
            color: #6b7280;
            border: 1px solid #d1d5db;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-outline-danger-custom {
            color: #dc2626;
            border-color: #dc2626;
        }

        .btn-outline-danger-custom:hover {
            background-color: #dc2626;
            color: white;
        }

        .btn-outline-secondary-custom {
            color: #6b7280;
            border-color: #6b7280;
        }

        .btn-outline-secondary-custom:hover {
            background-color: #6b7280;
            color: white;
        }

        .alert-custom {
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-weight: 500;
        }

        .submission-summary {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .summary-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .summary-row {
            margin-bottom: 0.5rem;
        }

        .summary-label {
            font-weight: 500;
            color: #6b7280;
        }

        .summary-value {
            color: #1f2937;
        }

        .history-section {
            margin-top: 2rem;
        }

        .history-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .history-table {
            font-size: 0.875rem;
        }

        .badge-approved {
            background-color: #10b981;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-denied {
            background-color: #ef4444;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .button-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
            margin-bottom: 1.5rem;
        }

        .clear-buttons {
            display: flex;
            gap: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-7">
                <div class="main-container">
                    <h1 class="main-title">Health Insurance Claim Prediction</h1>
                    <p class="subtitle">Enter patient information to predict claim approval status</p>

                    <!-- Error Alert -->
                    {% if error %}
                    <div class="alert alert-danger alert-custom" role="alert">
                        <strong>Error:</strong> {{ error }}
                    </div>
                    {% endif %}

                    <!-- Result Alert -->
                    {% if result %}
                    <div class="alert {% if result.decision == 'Approved' %}alert-success{% else %}alert-danger{% endif %} alert-custom" role="alert">
                        <strong>Prediction Result:</strong> {{ result.decision }}
                    </div>
                    {% endif %}

                    <!-- Prediction Form -->
                    <form method="POST" action="/predict">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="age" class="form-label">Age (18-100)</label>
                                <input type="number" class="form-control" id="age" name="age"
                                       min="18" max="100" required
                                       value="{{ form_values.get('age', '') }}">
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="sex" class="form-label">Sex</label>
                                <select class="form-select" id="sex" name="sex" required>
                                    <option value="">Select...</option>
                                    <option value="0" {% if form_values.get('sex') == 0 %}selected{% endif %}>Female</option>
                                    <option value="1" {% if form_values.get('sex') == 1 %}selected{% endif %}>Male</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="bmi" class="form-label">BMI (15.0-50.0)</label>
                                <input type="number" class="form-control" id="bmi" name="bmi"
                                       min="15" max="50" step="0.1" required
                                       value="{{ form_values.get('bmi', '') }}">
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="children" class="form-label">Number of Children (0-10)</label>
                                <input type="number" class="form-control" id="children" name="children"
                                       min="0" max="10" required
                                       value="{{ form_values.get('children', '') }}">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="smoker" class="form-label">Smoker</label>
                                <select class="form-select" id="smoker" name="smoker" required>
                                    <option value="">Select...</option>
                                    <option value="0" {% if form_values.get('smoker') == 0 %}selected{% endif %}>No</option>
                                    <option value="1" {% if form_values.get('smoker') == 1 %}selected{% endif %}>Yes</option>
                                </select>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="region" class="form-label">Region</label>
                                <select class="form-select" id="region" name="region" required>
                                    <option value="">Select...</option>
                                    <option value="0" {% if form_values.get('region') == 0 %}selected{% endif %}>Northeast</option>
                                    <option value="1" {% if form_values.get('region') == 1 %}selected{% endif %}>Southeast</option>
                                    <option value="2" {% if form_values.get('region') == 2 %}selected{% endif %}>Southwest</option>
                                    <option value="3" {% if form_values.get('region') == 3 %}selected{% endif %}>Northwest</option>
                                </select>
                            </div>
                        </div>

                        <!-- Primary Submit Button -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-custom btn-primary-custom">
                                Predict Claim Status
                            </button>
                        </div>
                    </form>

                    <!-- Clear Buttons (Outside Main Form) -->
                    <div class="button-row">
                        <div class="clear-buttons">
                            <form method="POST" action="/clear" style="display: inline;">
                                <button type="submit" class="btn btn-outline-custom btn-outline-danger-custom">
                                    Clear Form
                                </button>
                            </form>

                            <form method="POST" action="/clear-history" style="display: inline;">
                                <button type="submit" class="btn btn-outline-custom btn-outline-secondary-custom">
                                    Clear History
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Submission Summary -->
                    {% if result %}
                    <div class="submission-summary">
                        <h5 class="summary-title">Submission Summary</h5>
                        <dl class="row mb-0">
                            <div class="col-sm-6">
                                <div class="summary-row">
                                    <dt class="summary-label">Age:</dt>
                                    <dd class="summary-value">{{ form_values.get('age', 'N/A') }}</dd>
                                </div>
                                <div class="summary-row">
                                    <dt class="summary-label">Sex:</dt>
                                    <dd class="summary-value">{% if form_values.get('sex') == 0 %}Female{% elif form_values.get('sex') == 1 %}Male{% else %}N/A{% endif %}</dd>
                                </div>
                                <div class="summary-row">
                                    <dt class="summary-label">BMI:</dt>
                                    <dd class="summary-value">{{ form_values.get('bmi', 'N/A') }}</dd>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="summary-row">
                                    <dt class="summary-label">Children:</dt>
                                    <dd class="summary-value">{{ form_values.get('children', 'N/A') }}</dd>
                                </div>
                                <div class="summary-row">
                                    <dt class="summary-label">Smoker:</dt>
                                    <dd class="summary-value">{% if form_values.get('smoker') == 0 %}No{% elif form_values.get('smoker') == 1 %}Yes{% else %}N/A{% endif %}</dd>
                                </div>
                                <div class="summary-row">
                                    <dt class="summary-label">Region:</dt>
                                    <dd class="summary-value">
                                        {% if form_values.get('region') == 0 %}Northeast
                                        {% elif form_values.get('region') == 1 %}Southeast
                                        {% elif form_values.get('region') == 2 %}Southwest
                                        {% elif form_values.get('region') == 3 %}Northwest
                                        {% else %}N/A{% endif %}
                                    </dd>
                                </div>
                            </div>
                        </dl>
                        <div class="mt-3">
                            <dt class="summary-label">Decision:</dt>
                            <dd class="summary-value">
                                <span class="{% if result.decision == 'Approved' %}badge-approved{% else %}badge-denied{% endif %}">
                                    {{ result.decision }}
                                </span>
                            </dd>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Recent Predictions History -->
                    {% if history %}
                    <div class="history-section">
                        <h5 class="history-title">Recent Predictions</h5>
                        <div class="table-responsive">
                            <table class="table table-sm history-table">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>Decision</th>
                                        <th>Age</th>
                                        <th>Sex</th>
                                        <th>BMI</th>
                                        <th>Children</th>
                                        <th>Smoker</th>
                                        <th>Region</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for entry in history %}
                                    <tr>
                                        <td>{{ entry.timestamp }}</td>
                                        <td>
                                            <span class="{% if entry.decision == 'Approved' %}badge-approved{% else %}badge-denied{% endif %}">
                                                {{ entry.decision }}
                                            </span>
                                        </td>
                                        <td>{{ entry.age }}</td>
                                        <td>{% if entry.sex == 0 %}F{% else %}M{% endif %}</td>
                                        <td>{{ entry.bmi }}</td>
                                        <td>{{ entry.children }}</td>
                                        <td>{% if entry.smoker == 0 %}No{% else %}Yes{% endif %}</td>
                                        <td>
                                            {% if entry.region == 0 %}NE
                                            {% elif entry.region == 1 %}SE
                                            {% elif entry.region == 2 %}SW
                                            {% else %}NW{% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>